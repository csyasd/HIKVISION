<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width,initial-scale=1.0">
    <link rel="icon" href="<%= BASE_URL %>favicon.ico">
    <title><%= htmlWebpackPlugin.options.title %></title>
    
    <!-- FLV.js 播放器 - 本地文件 -->
    <script src="<%= BASE_URL %>flv.min.js" 
            onerror="console.error('本地 flv.js 加载失败，尝试备用CDN'); loadFlvBackup();"></script>
    <script src="https://webapi.amap.com/maps?v=2.0&key=933b70f0dfaf67b0f950d1682dc27ca1"></script>
    <script>
        // 备用flv.js加载函数（如果本地文件加载失败，使用CDN）
        function loadFlvBackup() {
            const script = document.createElement('script');
            script.src = 'https://cdn.jsdelivr.net/npm/flv.js@1.6.2/dist/flv.min.js';
            script.onerror = function() {
                console.error('所有flv.js源都加载失败，请检查网络连接或确保本地文件存在');
                window.flvjs = null;
            };
            script.onload = function() {
                console.log('✅ 备用CDN flv.js加载成功');
            };
            document.head.appendChild(script);
        }
        
        // flv.js加载检测
        window.addEventListener('DOMContentLoaded', function() {
            // 延迟检测，确保脚本完全加载
            setTimeout(function() {
                console.log('=== FLV播放器加载检测 ===');
                console.log('flv.js:', typeof flvjs !== 'undefined' ? '✅ 已加载（本地文件）' : '❌ 未加载');
                if (typeof flvjs !== 'undefined') {
                    console.log('✅ FLV播放器已就绪（延迟1-2秒）');
                    console.log('浏览器支持:', flvjs.isSupported() ? '✅' : '❌');
                } else {
                    console.error('❌ flv.js未定义，视频播放功能将不可用');
                    console.error('请检查 public/flv.min.js 文件是否存在');
                }
                
                // 高德地图加载检测
                console.log('=== 高德地图加载检测 ===');
                console.log('AMap:', typeof AMap !== 'undefined' ? '✅ 已加载' : '❌ 未加载');
                if (typeof AMap !== 'undefined') {
                    console.log('✅ 高德地图API已就绪');
                }
            }, 1000);
        });
    </script>
  </head>
  <body>
    <noscript>
      <strong>We're sorry but <%= htmlWebpackPlugin.options.title %> doesn't work properly without JavaScript enabled. Please enable it to continue.</strong>
    </noscript>
    <div id="app"></div>
    <!-- built files will be auto injected -->
  </body>
</html>

